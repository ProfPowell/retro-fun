<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plasma // RETRO FUN</title>
<style>
  * { margin: 0; padding: 0; }
  body { background: #000; overflow: hidden; }
  canvas { display: block; image-rendering: pixelated; }
  .hud {
    position: fixed;
    top: 1rem;
    left: 1rem;
    font-family: 'Courier New', monospace;
    font-size: 0.7rem;
    color: rgba(255,255,255,0.3);
    letter-spacing: 0.15em;
    text-transform: uppercase;
    pointer-events: none;
    z-index: 10;
  }
  .back {
    position: fixed;
    top: 1rem;
    right: 1rem;
    font-family: 'Courier New', monospace;
    font-size: 0.7rem;
    color: #444;
    text-decoration: none;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    z-index: 10;
  }
  .back:hover { color: #ff00ff; }
</style>
</head>
<body>
<div class="hud">Plasma &bull; Old School Color Cycling</div>
<a class="back" href="../../">&larr; Back</a>
<canvas id="c"></canvas>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

// Low res for chunky pixel look
const SCALE = 4;
let W, H, pw, ph;
let imageData;

function resize() {
  W = window.innerWidth;
  H = window.innerHeight;
  canvas.style.width = W + 'px';
  canvas.style.height = H + 'px';
  pw = Math.ceil(W / SCALE);
  ph = Math.ceil(H / SCALE);
  canvas.width = pw;
  canvas.height = ph;
  imageData = ctx.createImageData(pw, ph);
}
window.addEventListener('resize', resize);
resize();

// Build palette (256 colors cycling through psychedelic hues)
const palette = new Uint8Array(256 * 3);
for (let i = 0; i < 256; i++) {
  palette[i * 3]     = Math.floor(128 + 128 * Math.sin(Math.PI * i / 32));
  palette[i * 3 + 1] = Math.floor(128 + 128 * Math.sin(Math.PI * i / 64 + 2.094));
  palette[i * 3 + 2] = Math.floor(128 + 128 * Math.sin(Math.PI * i / 128 + 4.188));
}

// Precompute sin/cos table
const SIN = new Float64Array(512);
for (let i = 0; i < 512; i++) {
  SIN[i] = Math.sin(i * Math.PI * 2 / 256);
}

let time = 0;

function draw() {
  const d = imageData.data;
  const t1 = time * 1.3;
  const t2 = time * 0.7;
  const t3 = time * 1.1;
  const t4 = time * 0.5;

  for (let y = 0; y < ph; y++) {
    for (let x = 0; x < pw; x++) {
      // Classic plasma formula: sum of sines
      const v1 = SIN[(Math.floor(x + t1) & 255)];
      const v2 = SIN[(Math.floor(y + t2) & 255)];
      const v3 = SIN[(Math.floor((x + y + t3)) & 255)];
      const dist = Math.sqrt((x - pw / 2) * (x - pw / 2) + (y - ph / 2) * (y - ph / 2));
      const v4 = SIN[(Math.floor(dist * 2 + t4) & 255)];

      const color = Math.floor(((v1 + v2 + v3 + v4) + 4) * 32) & 255;

      const idx = (y * pw + x) * 4;
      d[idx]     = palette[color * 3];
      d[idx + 1] = palette[color * 3 + 1];
      d[idx + 2] = palette[color * 3 + 2];
      d[idx + 3] = 255;
    }
  }

  ctx.putImageData(imageData, 0, 0);
  time += 0.5;
  requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
